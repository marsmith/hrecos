Martyn Smith
12/10/2018

Process for importing legacy HRECOS CSV tables into mysql/mariadb database
------------------------------------------------------------------------------

1.  Create new database
    CREATE DATABASE hrecos;

2.  Create new table for each csv ('raw' and 'post') and load data

    CREATE TABLE IF NOT EXISTS hrecos.raw (site_name VARCHAR(12), `parameter` VARCHAR(12), `datetime` DATETIME, value FLOAT, flag VARCHAR(12), comment VARCHAR(12), tz_code VARCHAR(12), agency_id VARCHAR(12));

3a. Import Data (command line)
    [LOCAL]
    mysqlimport -h localhost -P 3306 -u hawdis -pabc123 --local --ignore-lines=1 --fields-terminated-by=',' --lines-terminated-by='\n' hrecos raw.csv -v
    [REMOTE]
    mysqlimport -h mysql.natweb.usgs.gov -P 3306 -u hrecos -prsT13zKDN9fp9EVI --local --ignore-lines=1 --fields-terminated-by=',' --lines-terminated-by='\n' hrecos raw.csv -v

3b. Import Data (SQL query)
    LOAD DATA LOCAL INFILE 'c:/NYBackup/GitHub/hrecos/data_import/raw.csv' INTO TABLE hrecos.raw FIELDS TERMINATED BY ',' IGNORE 1 ROWS;

4.  Add auto increment primary key field
    ALTER TABLE hrecos.raw ADD `id` INT NOT NULL AUTO_INCREMENT PRIMARY KEY FIRST;

4. Create indexes
    CREATE INDEX raw_datetime_IDX ON hrecos.raw (`datetime`);
    CREATE INDEX raw_site_name_IDX ON hrecos.raw (`site_name`);
    CREATE INDEX raw_parameter_IDX ON hrecos.raw (`parameter`);

Appendix
------------------------------
Unique site names:
HRALBPH
HRALBPM
HRBZAKH
HRBZAKM
HRLCK8H
HRLCK8M
HRMARPH
HRMARPHS
HRNOPTH
HRNOPTM
HRPMNTH
HRPMNTM
HRPR26H
HRPR26M
HRPR84H
HRPR84M
HRPVSC
HRREXBR
HRSCHDH
HRSCHDM
HRTVBM
HRTVBNH
HRTVBSH
HRUTICA
HRWSTPTH
STCPBY1
STCPPB
STGWBR4

Unique parameters:
CHLA
DEPTH
DO
DOPC
ELEV
PH
SALT
SPCO
TURB
VELMC
VELNS
WTMP
ATMP
BARO
DEWP
GST
PAR
RAIN
RAINDC
RHUM
WD
WDEV
WSPD
RAD
STMP
ABSP
COND
PWL